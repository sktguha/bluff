<head>
    <script src="clientUtil/jquery-1.10.1.min.js"></script>
    <script src="clientUtil/jquery-ui.min.js"></script>
    <link rel="stylesheet" type="text/css" href="res/css/semantic.min.css"/>
    <script src="res/js/semantic.min.js"></script>
    <script src="res/js/annyang.min.js"></script>
    
    <script>
        function checkRoomAndRedirect(){
            var name = $('#room-name').val();
            $.ajax({
                url : '/?checkroom='+name,
                success : function(result){
                    if(result === "available"){
                        //document.cookie = "roomName="+name;
                        visitRoom(name);
                    }  else {
                        $('.ui.modal').modal('show');
                    }
                }
            });
        }
        function visitRoom(name){
            localStorage['room'] = name;
            location.href = "/roomClient.html";
        }
        function populateRooms(table, data){
            //TODO : need to add how many players per room
           data = JSON.parse(data);
            data.forEach(function(d){
                var tr = document.createElement("tr");
                $(tr).addClass("rooms");
                $(tr).text(d);
                $(table).append(tr);
            });
            $('#roomtable').on("click", function(e){
                var tr = e.srcElement || e.target;
                visitRoom($(tr).text());
            });
        }
        $.ajax({
            url : '/?roomdata=true',
            success : function(data){
                populateRooms($('#roomtable')[0],data);
            }
        });
    </script>
<script>
if(annyang){
    var commands = { "hi":function(){
        alert('hi to you too');
    }};
}
annyang.addCommands(commands);
annyang.start();
</script>

</head>
<body>

<div class="row">
<div class="ui segment">
<center><h2>Welcome to Bluff</h2></center>
</div>
</div><br><br>
<div class="ui four column grid">
<div class="six wide column">
</div>
<div class="ui blue segment">

<div class="ui labeled input">
  <span class="ui label">
    Room Name: 
  </span>
  <input type="text" placeholder="Create/Join a Room" id='room-name'>
</div><br><br><br>
<center><div class="ui submit teal button" onclick = "checkRoomAndRedirect()">Create/Join</div></center>
<table id='roomtable'></table>
</div>
</div>


<div class="ui modal">
  <div class="header">Alert</div>
  <div class="content">
    <p>oops Empty Room name or Room name already taken. please try with a different name!..</p>
  </div>
  <div class="actions">
    <div class="ui approve button">Close</div>
    </div>
</div>
</body>